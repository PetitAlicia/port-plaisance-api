<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page d'accueil</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
</head>

<body>
    <div class="body-index">
        <header>
        <h1>Application de Gestion des Réservations de Catway </h1>
        <p>Cette application permet de gérer les utilisateurs (créer ou supprimer un utilisateur), les catways (créer, modifier, 
            supprimer ou afficher les détails d'un catway), et les réservations (créer, supprimer ou afficher les détails 
            d'une réservation).
        </p>
        <a href="/documentation.html">Lien vers la documentation de l'API</a>
        </header>

        <main>
            <h2>Connexion</h2>
            <form id="loginForm">
                <label for="email">E-mail :</label>
                <input type="email" id="email" name="email" required><br><br>
                <label for="password">Mot de passe :</label>
                <input type="password" id="password" name="password" required><br><br>
                <button type="submit">Se connecter</button>
            </form>
        </main>

        <footer>
            <p>&copy; 2024 Port de Plaisance Russell</p>
        </footer>
    </div>
    
    <script>
        document.getElementById('loginForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const email = this.email.value;
            const password = this.password.value;
    
            try {
                const response = await fetch('/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ email, password })
                });
    
                if (!response.ok) throw new Error('Erreur de connexion');
    
                const data = await response.json();

                localStorage.setItem('token', data.token);
                window.location.href = '/dashboard.html';
            } catch (error) {
                console.error('Erreur :', error);
                alert('Échec lors de la connexion : ' + error.message);
            }
        });
    </script>
    
</body>

</html>
